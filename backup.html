<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>USAWC MilSymbol Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- MilSymbol -->
  <script src="https://unpkg.com/milsymbol/dist/milsymbol.js"></script>
  <script src="./assets/milsymbol.js"></script>
  <!-- Styles -->
  <link rel="stylesheet" href="./assets/style.css">
  <link rel="icon" type="image/x-icon" href="./img/logoipsum-399.svg">
</head>
<body>
  <!-- HEADER -->
  <header>
    <img src="./img/logoipsum-399.svg" alt="Logo Left">
    <h1>USAWC MilSymbol Generator</h1>
    <img src="./img/logoipsum-374.svg" alt="Logo Right">
  </header>
  <div class="main-layout">
    <!-- SIDEBAR -->
    <aside class="symbolSideBar">
      <div id="symbolPreview"></div>
      <button id="saveSvg">‚¨áÔ∏è Save SVG</button>
      <button id="resetSymbol">üîÑ Reset</button>
    </aside>
    <!-- CONTROL PANEL -->
    <main class="controls">
      <div class="control-group">
        <label for="shape">Symbol Set</label>
        <select id="shape">
          <option value="SFGPUCI----*****">Infantry</option>
          <option value="SFGPUCIL---*****">Light Infantry</option>
          <option value="SFGPUCAC---*****">Armor</option>
          <option value="SFGPUCAA---*****">Airborne</option>
          <option value="SFGPUCDS---*****">Signal</option>
          <option value="SFGPUCFA---*****">Artillery</option>
        </select>
      </div>
      <div class="control-group">
        <label for="affiliation">Affiliation</label>
        <select id="affiliation">
          <option value="F">Friendly</option>
          <option value="H">Hostile</option>
          <option value="N">Neutral</option>
          <option value="U">Unknown</option>
        </select>
      </div>
      <div class="control-group">
        <label for="color">Symbol Color</label>
        <input type="color" id="color" value="#00aaff">
      </div>
      <div class="control-group">
        <label for="label">Unique Designation</label>
        <input type="text" id="label" placeholder="e.g. Alpha 1">
      </div>
      <div class="control-group">
        <label for="quantity">Quantity</label>
        <input type="text" id="quantity" placeholder="e.g. 3">
      </div>
      <div class="control-group">
        <label for="higherFormation">Higher Formation</label>
        <input type="text" id="higherFormation" placeholder="e.g. 2nd Battalion">
      </div>
      <div class="control-group">
        <label for="status">Status</label>
        <select id="status">
          <option value="">Present</option>
          <option value="A">Anticipated/Planned</option>
          <option value="P">Fully Capable</option>
          <option value="C">Damaged</option>
          <option value="X">Destroyed</option>
        </select>
      </div>
      <div class="control-group">
        <label for="echelon">Echelon</label>
        <select id="echelon">
          <option value="">None</option>
          <option value="A">Team/Crew</option>
          <option value="B">Squad</option>
          <option value="C">Section</option>
          <option value="D">Platoon</option>
          <option value="E">Company</option>
          <option value="F">Battalion</option>
          <option value="G">Regiment</option>
          <option value="H">Brigade</option>
          <option value="I">Division</option>
          <option value="J">Corps</option>
        </select>
      </div>
      <div class="control-group">
        <label for="mobility">Mobility</label>
        <select id="mobility">
          <option value="">None</option>
          <option value="MO">Wheeled</option>
          <option value="MS">Tracked</option>
          <option value="MU">Half-Tracked</option>
          <option value="MB">Amphibious</option>
          <option value="MC">Airborne</option>
        </select>
      </div>
      <div class="control-group">
        <label for="hq">HQ / Staff</label>
        <select id="hq">
          <option value="">None</option>
          <option value="A">Headquarters</option>
        </select>
      </div>
      <div class="control-group">
        <label for="reinforcedReduced">Reinforced / Reduced</label>
        <select id="reinforcedReduced">
          <option value="">None</option>
          <option value="+">Reinforced (+)</option>
          <option value="-">Reduced (-)</option>
          <option value="¬±">Reinforced/Reduced (¬±)</option>
        </select>
      </div>
      <div class="control-group">
        <label for="direction">Direction (Degrees)</label>
        <input type="number" id="direction" min="0" max="360" value="45">
      </div>
      <div class="control-group">
        <label for="hideText">Hide Text</label>
        <input type="checkbox" id="hideText">
      </div>
    </main>
  </div>
  <script>
    // === Element References ===
    const els = {
      shape: document.getElementById("shape"),
      affiliation: document.getElementById("affiliation"),
      color: document.getElementById("color"),
      label: document.getElementById("label"),
      quantity: document.getElementById("quantity"),
      higherFormation: document.getElementById("higherFormation"),
      status: document.getElementById("status"),
      echelon: document.getElementById("echelon"),
      mobility: document.getElementById("mobility"),
      hq: document.getElementById("hq"),
      reinforcedReduced: document.getElementById("reinforcedReduced"),
      direction: document.getElementById("direction"),
      hideText: document.getElementById("hideText"),
      preview: document.getElementById("symbolPreview"),
      saveSvg: document.getElementById("saveSvg"),
      reset: document.getElementById("resetSymbol")
    };

    // === Build SIDC ===
    function buildSIDC(baseSIDC, aff) {
      return baseSIDC.substring(0, 1) + aff + baseSIDC.substring(2);
    }
    // === Update Symbol Preview ===
    function updateSymbol() {
      const baseSIDC = els.shape.value || "SFGPUCI----*****";
      const sidc = buildSIDC(baseSIDC, els.affiliation.value);
      const directionValue = parseFloat(els.direction.value) || 0;
      const opts = {
        size: 130,
        fillColor: els.color.value,
        direction: directionValue,
        svg: true,
        uniqueDesignation: els.hideText.checked ? "" : els.label.value,
        quantity: els.hideText.checked ? "" : els.quantity.value,
        higherFormation: els.hideText.checked ? "" : els.higherFormation.value,
        status: els.status.value,
        echelon: els.echelon.value,
        headquartersElement: els.hq.value,
        mobility: els.mobility.value,
        reinforcedReduced: els.reinforcedReduced.value
      };
      const symbol = new ms.Symbol(sidc, opts);
      els.preview.innerHTML = "";
      els.preview.appendChild(symbol.asDOM());
    }
    // === Save as SVG ===
    function saveAsSVG() {
      const svg = els.preview.querySelector("svg");
      if (!svg) return alert("‚ö†Ô∏è No symbol to save!");
      const blob = new Blob([new XMLSerializer().serializeToString(svg)], {
        type: "image/svg+xml"
      });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = `${els.label.value || "milsymbol"}.svg`;
      link.click();
      URL.revokeObjectURL(link.href);

    }


    // === Reset ===

    function resetSymbol() {

      if (!confirm("Reset all symbol settings?")) return;

      document.querySelectorAll("input, select").forEach(el => {

        if (el.type === "checkbox") el.checked = false;

        else if (el.tagName === "SELECT") el.selectedIndex = 0;

        else el.value = "";

      });

      els.color.value = "#00aaff";

      els.direction.value = "45";

      updateSymbol();

    }
    // === Event Listeners ===
    Object.values(els).forEach(el => {
      if (el && el.tagName) el.addEventListener("input", updateSymbol);
    });
    els.saveSvg.addEventListener("click", saveAsSVG);
    els.reset.addEventListener("click", resetSymbol);
    updateSymbol();
  </script>

</body>

</html>